###############################################################################
#                           CRYPTO AI TRADING BOT
#                     ENVIRONMENT CONFIGURATION FILE
#
# Copy this file to `.env.local` and fill in your actual values.
# NEVER commit `.env.local` to version control!
###############################################################################

##################################################
# ENVIRONMENT & MODE
##################################################
# Options: development, staging, production
ENVIRONMENT=development

# Trading mode: paper (simulation) or live (real money)
MODE=paper

# Main trading symbol
SYMBOL=BTC/USDT

# Loop interval in seconds (be mindful of API rate limits)
LOOP_INTERVAL=15

# Timezone for timestamps
TZ=UTC


##################################################
# API CREDENTIALS - NEVER COMMIT THESE!
##################################################
# Get API keys from: https://www.binance.com/en/my/settings/api-management
# Required permissions: Enable Reading, Enable Spot & Margin Trading

# Live account (REAL MONEY - BE CAREFUL!)
BINANCE_API_KEY=
BINANCE_API_SECRET=

# Testnet account (https://testnet.binance.vision/)
BINANCE_TESTNET_API_KEY=
BINANCE_TESTNET_API_SECRET=

# Use testnet (true) or mainnet (false)
BINANCE_TESTNET=false


##################################################
# TRADING PARAMETERS
##################################################
# Initial virtual cash for paper trading
INITIAL_CASH=1000.0

# Trade size configuration
# For BUY orders: Amount in quote currency (USDT)
TRADE_AMOUNT_QUOTE=15.0
# For SELL orders: Amount in base currency (BTC) - or set to 'auto' for position-based
TRADE_AMOUNT_BASE=auto

# Position sizing limits
MAX_POSITION_USDT=50.0                    # Maximum position size in USDT
MIN_TRADE_NOTIONAL=10.0                   # Binance minimum: $10 for BTC/USDT
MAX_DAILY_TRADES=10                       # Daily trade limit for safety

# Order settings
ORDER_TIMEOUT_SECONDS=30                  # Cancel order if not filled
ALLOW_PARTIAL_FILLS=true                  # Accept partial order fills


##################################################
# RISK MANAGEMENT
##################################################
# Maximum drawdown (0.20 = 20%)
MAX_DRAWDOWN=0.20

# Risk per trade (0.01 = 1% of equity)
RISK_PER_TRADE=0.01

# Minimum risk-reward ratio
MIN_RISK_REWARD=1.5

# Stop loss configuration
STOP_LOSS_ATR_MULTIPLIER=1.5              # ATR multiplier for stop loss
TRAILING_STOP_ACTIVATE_ATR=1.0            # Activate trailing after X ATR profit
TRAILING_STOP_ATR_MULTIPLIER=1.0          # Trailing stop distance in ATR

# Circuit breaker settings
MAX_CONSECUTIVE_LOSSES=3                  # Stop trading after X consecutive losses
MAX_DAILY_LOSS_PERCENT=5.0                # Maximum daily loss percentage
COOLDOWN_MINUTES_AFTER_LOSS=30            # Cooldown period after significant loss


##################################################
# AI & ML CONFIGURATION
##################################################
# State window size (number of candles for AI state)
AI_WINDOW=50

# AI model paths (relative to project root)
MODEL_PPO_MAIN=ai/models/ppo_live.zip
MODEL_PPO_TREND=ai/models/ppo_trend.zip
MODEL_PPO_MEAN=ai/models/ppo_mean.zip
MODEL_LSTM=ai/models/lstm_price.pt
MODEL_RULE_BASED=none                     # Use built-in rule-based if no file

# Online learning settings
ENABLE_ONLINE_LEARNING=false              # WARNING: Can degrade model performance
FINE_TUNE_EVERY=500                       # Steps between fine-tuning
FINE_TUNE_STEPS=512                       # Training steps per fine-tune
MIN_REPLAY_BUFFER_SIZE=200                # Minimum experiences before training
MAX_REPLAY_BUFFER_SIZE=10000              # Maximum experiences to keep

# Ensemble voting
ENSEMBLE_MIN_CONFIDENCE=0.3               # Minimum confidence to accept prediction
ENSEMBLE_TIE_PREFERENCE=conservative      # conservative (hold) or aggressive (act)


##################################################
# NETWORK & CONNECTIVITY
##################################################
# Proxy configuration (optional)
# Format: http://user:pass@host:port,https://host:port,socks5://host:port
PROXIES=

# Proxy test URL (to verify proxy works)
PROXY_TEST_URL=https://api.binance.com/api/v3/time

# DNS fallback IPs (use if DNS resolution fails)
# Leave empty to use system DNS
DNS_FALLBACK_IPS=

# Request timeout in milliseconds
REQUEST_TIMEOUT=30000

# Binance recvWindow in milliseconds
RECV_WINDOW=60000

# Connection retry settings
MAX_CONNECTION_RETRIES=3
RETRY_BACKOFF_SECONDS=5


##################################################
# DATABASE & STORAGE
##################################################
# SQLite database for trade records
TRADES_DB=/var/lib/crypto-ai-bot/trades.db  # Absolute path recommended for services

# Experience replay buffer (for AI training)
REPLAY_BUFFER_PATH=/var/lib/crypto-ai-bot/replay_buffer.csv

# Model backup directory
MODEL_BACKUP_DIR=/var/lib/crypto-ai-bot/backups

# Log files
LOG_DIR=/var/log/crypto-ai-bot
LOG_FILE=crypto-ai-bot.log
LOG_MAX_SIZE_MB=100                       # Rotate log file at 100MB
LOG_BACKUP_COUNT=5                        # Keep 5 rotated logs


##################################################
# LOGGING & DEBUGGING
##################################################
# Debug mode - WARNING: exposes sensitive data in logs!
DEBUG=false

# Log level: DEBUG, INFO, WARNING, ERROR, CRITICAL
LOG_LEVEL=INFO

# Log format
LOG_FORMAT=json                           # json or text

# Performance metrics logging
ENABLE_METRICS=true
METRICS_INTERVAL_SECONDS=60


##################################################
# MONITORING & HEALTH CHECKS
##################################################
# Health check server (optional)
HEALTH_CHECK_ENABLE=true
HEALTH_CHECK_PORT=8080
HEALTH_CHECK_PATH=/health

# Monitoring alerts
ENABLE_ALERTS=false
ALERT_WEBHOOK_URL=
ALERT_ON_ERROR=true
ALERT_ON_MAX_DRAWDOWN=true

# Performance monitoring
MONITOR_LATENCY=true
MAX_ALLOWED_LATENCY_MS=5000


##################################################
# FAILSAFE & RECOVERY
##################################################
# Maximum consecutive errors before restart
MAX_ERRORS_BEFORE_RESTART=10

# Automatic restart settings
AUTO_RESTART_ENABLE=true
AUTO_RESTART_DELAY_SECONDS=60

# State recovery
ENABLE_STATE_RECOVERY=true
STATE_BACKUP_INTERVAL_MINUTES=15


##################################################
# ADVANCED SETTINGS (Modify with caution)
##################################################
# Rate limiting
ENABLE_RATE_LIMITING=true
MAX_REQUESTS_PER_MINUTE=60
MIN_REQUEST_INTERVAL_MS=100

# Data caching
CACHE_TTL_SECONDS=5
ENABLE_OHLCV_CACHE=true
ENABLE_BALANCE_CACHE=true

# Feature flags
ENABLE_POSITION_TRACKING=true
ENABLE_RISK_ENGINE=true
ENABLE_ENSEMBLE_VOTING=true

# Trading hours restriction (UTC)
TRADING_HOURS_START=00:00
TRADING_HOURS_END=23:59
ENFORCE_TRADING_HOURS=false


###############################################################################
# END OF CONFIGURATION
#
# For environment-specific settings, create:
# - .env.development (local development)
# - .env.staging (testing environment)  
# - .env.production (live trading)
# - .env.local (personal overrides, git-ignored)
###############################################################################